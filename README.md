**********************************************
# Diffusion Models on MNIST Dataset
**********************************************

## Description
This project contains the codes used for training and evaluating Denoising Diffusion Probabilistic Model (DDPM) and Defading Diffusion Model (DDM). All the results and figures shown in the report can be reproduced following the instructions below.

## Installaion
To install this project, follow these steps:
1. Clone from the Gitlab Repository
```
git clone https://github.com/Yichizz/hot_vs_cold_diffusion.git
```
2. Create and activate new conda environment
```
cd hot_vs_cold_diffusion
conda env create -f environment.yml
conda activate cw_aml
```

## Usage
There 2 two main scripts, called ddpm.py and ddm.py, containing codes for Denoising Diffusion Probabilistic Model and Defading Diffusion Model respectively. To run them on the command line, you need to specify the parameter file after --ini_file and the running mode to be train or evaluate after --mode, e.g.
```
python ddpm.py --ini_file parameters.ini --mode train 
```
Results will be displayed after execution, training losses will be stored in the losses folder, generated samples will be saved as .png files in the samples folder, and trained model state will be saved in the model folder. All of these outputs will be named according to the model_name parameter value in parameters.ini.

The parameter configuration file, parameters.ini, contains sections of hyperparameters used during model training and evaluation. You need to change it according to your need each time before running the main scripts. To reproduce the results from the report, please change the parameter values according to the example parameter files in the model folder based on which model you want to run.

The helper package, *diffusion_mnist*, contains modules for model architectures of DDPM and DDM models, train and evaluate functions, and other utility functions, which are imported and used in the main codes. To generate documentations of the *diffusion_mnist* package, you need to install doxygen, and run
```
cd docs
doxygen
```

## Github Copilot
Copilot hasn't been shut down since it can enhance coding efficiency. However, it has been mostly used for generating documentations and codes for plots, the overall structure and many other functions were predominantly created by myself. Codes fully generated by AI tools are all pointed out in the comments.

## License
This project is licensed under the [MIT License] - see the [license] file for details.
## Author
Yichi Zhang (yz870)

27/03/2024
